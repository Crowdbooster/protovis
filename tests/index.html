<head>
    <html>
        <title>Tests</title>
    </html>
    <body>
        <h1>Protovis Tests, Partially Applying SVGWeb</h1>

        This protovis pre-3.2 includes a small number of changes over
        the top of protovis 3.2 that allow it to work with SVGWeb.
    <p>
        You can find a fork of the official Protovis source code
        with these changes at <a href="http://gitorious.org/~jlove/protovis/jloves-protovis">
            gitorious</a> (http://gitorious.org/~jlove/protovis/jloves-protovis).
    <p>
        Or you can download the necessary files here:
        <ul>
            <li>Updated protovis file <a href="../protovis-r3.2.js">production</a>
            , <a href="../protovis-d3.2.js">test</a></li>
            <li>The SVGWeb code <a href="../3rdparty/svg.js">svg.js</a> (this
            includes some small changes to ensure events work in protovis),
            <a href="../3rdparty/svg.htc">svg.htc</a> and
            <a href="../3rdparty/svg.swf">svg.swf</a>.
       </ul>

    To make protovis work using SVGWeb, you need to alter your coding
    style slightly, basically because you need to make it work under IE.
    Namely:
        <ul>
            <li>Don't use function expressions like <code> function () a.b </code>,
            instead you have to write long form: <code> function () { return a.b } </code>.
            This is an IE limitation.
            <li>Wrap your code in <code>&lt;script> type="text/javascript"&gt;</code>
            rather than <code>type="text/javascript+protovis"</code>. This ensures
            that all browsers work smoothly with the following change:
            <li>Wrap your protovis <code>render()</code> call in a function
            that is called on page load. This is <b>required</b> for SVGWeb to
            load correctly. In Chrome it is not necessary, in FireFox if you don't
            do this you sometimes get two graphs, and IE doesn't work. for example:
<pre>
pv.listen (window, "load", function () {
 // all code to create the protovis graph, including the 'vis.render()' line.
});
</pre>
            <li>conditionally include the SVGWeb <code>svg.js</code> file. You
            probably don't want to use SVGWeb for non-IE browsers (at least yet).
            You can do this, by, at the top of your HTML file:
<pre>
&lt;!--[if IE]>
    &lt;script type="text/javascript" src="../../3rdparty/svg.js" data-path="../../3rdparty/">&lt;/script>
&lt;![endif]-->
    &lt;script type="text/javascript" src="../../protovis-d3.2.js">&lt;/script>
</pre>
            Make sure to you include 'svg.js' first - it MUST be the first
            javascript file you include. The 'data-path' attribute must reference
            the directory <code>svg.swf</code> is in.
    </ul>
 <p>
        This SVGWeb implementation is not perfect. There are a few bugs
        and what-not to work out still:
        <ul>
            <li>The <code>title</code> property does not work via SVGWeb.
            Use a label instead if possible.
            <li>Completely re-rendering a graph may or may not work. It
            seems a little flakey. That is - calling <code>vis.render()</code>
            on a visualisation previously rendered may or may not work.
            I'm sure this is fairly simple to fix.<b>upate:</b> This works
            fine on the polar clock example.
            <li>Creating a whole new visualistion (by going <code> var vis = new pv.Panel()</code>
            and rendering to the same div as a previous render currently is
            not good - this is to do with the underlying flash object not
            cleaning up correctly.
            <li>Text labels seem to have their vertical text-alignment 
            default to something different to non-SVGWeb rendering. It
            is likely easy to fix....<b>update:</b> A change has been implemented
            to make the default text size look better, but it is likely
            to need to be tweaked for text sizes larger than 10px.
            <li>The flash renderer is slower than native rendering, so
            frequent re-rendering of a graph will easily bog the browser
            down, and probably won't work (so don't try sub-1s re-rendering).
            This can be alleviated by only re-rendering child marks on the
            graph, and longer term we can probably find some performance
            improvements for it.
            <li>The flash renderer doesn't seem to get circle's correct - 
            see the polar clock for an example. This also occurs in other
            situations - e.g. see the antibiotics example.
            <li>Rotated text does not work with SVGWeb. This is due to a known
            limitation with the Flash SVG rendering. See 
            <a href="http://code.google.com/p/svgweb/issues/detail?id=158">
            this SVGWeb bug report</a> for details.
        </ul>

        <h2>Tests</h2>

    <p>

        The following links are links that have been altered to work with
        this version of protovis. They have been configured to run SVGWeb
        in flash on all browsers, so you see what happens using the flash
        renderer even in FireFox and Chrome.
    <p>
            

<a href="./examples/wheat.html">./examples/wheat.html</a><br>
<a href="./examples/polarclock.html">./examples/polarclock.html</a><br>
<a href="./examples/antibiotics.html">./examples/antibiotics.html</a><br>
<a href="./interaction/bar1.html">./interaction/bar1.html</a><br>
<a href="./mark/bar-column-grouped.html">./mark/bar-column-grouped.html</a><br>
<a href="./mark/area.html">./mark/area-stacked.html</a><br>
    </body>
</html>
